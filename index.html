<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SIM Database — Wasi Technovation</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{--glass: rgba(17,24,39,0.65);}
    html,body,#app{height:100%;}
    body{font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;}
    canvas#matrix{position:fixed;inset:0;z-index:0;opacity:0.18;mix-blend-mode:screen}
    .card-appear{animation:cardIn .5s ease both}
    @keyframes cardIn{from{transform:translateY(8px);opacity:0}to{transform:none;opacity:1}}
    .results-scroll{max-height:360px;overflow:auto;padding-right:6px}
    .chip{background:rgba(255,255,255,0.04);padding:.25rem .5rem;border-radius:9999px;font-size:.8rem}
    input:focus{outline:none;box-shadow:0 0 0 4px rgba(34,197,94,0.08)}
  </style>
</head>
<body class="bg-gradient-to-b from-black via-slate-900 to-black text-slate-200 antialiased">
<canvas id="matrix" aria-hidden="true"></canvas>
<div id="app" class="relative z-10 min-h-screen flex items-center justify-center px-6 py-12">
  <main class="w-full max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-8">
    <section class="card-appear bg-[var(--glass)] backdrop-blur-md rounded-2xl border border-slate-800 p-6 shadow-2xl">
      <header class="flex items-center justify-between mb-4">
        <div>
          <h1 class="text-2xl font-semibold text-green-300">SIM Database</h1>
          <p class="text-sm text-slate-400">Search by mobile (03xxxxxxxxx) or 13-digit CNIC</p>
        </div>
        <div class="text-right"><span class="chip">Wasi Technovation</span></div>
      </header>
      <form method="POST" id="searchForm" class="space-y-4" novalidate>
        <div class="relative">
          <input id="inputValue" name="inputValue" inputmode="numeric" autocomplete="off"
                 pattern="(03\d{9}|\d{13})" placeholder="03xxxxxxxxx or 13-digit CNIC"
                 required class="w-full p-3 pr-32 rounded-lg bg-slate-800 border border-slate-700 focus:ring-2 focus:ring-green-400 transition" />
          <button type="submit" class="absolute right-1 top-1 bottom-1 bg-green-400 text-black px-4 rounded-lg font-semibold">Search</button>
        </div>
        <div class="flex gap-2 text-xs">
          <button type="button" id="pasteBtn" class="flex-1 bg-slate-700 rounded-lg py-2">Paste</button>
          <button type="button" id="historyBtn" class="flex-1 bg-slate-700 rounded-lg py-2">History</button>
        </div>
        <div id="status" aria-live="polite"></div>
      </form>
      <div id="resultArea" class="mt-5"></div>
      <div class="mt-6 flex gap-3">
        <button id="contactBtn" class="flex-1 bg-transparent border border-slate-700 rounded-lg py-2">Contact Dev</button>
        <button id="reportBtn" class="flex-1 bg-blue-600 rounded-lg py-2">Report Issue</button>
      </div>
      <footer class="mt-6 text-xs text-slate-500">Note: This page contacts an external API to fetch public SIM records.</footer>
    </section>
    <aside class="card-appear bg-[var(--glass)] rounded-2xl border border-slate-800 p-6 shadow-2xl">
      <h3 class="text-lg font-medium text-cyan-300 mb-2">Latest Result</h3>
      <div id="latestCard" class="bg-slate-800 rounded-lg p-4 text-sm">
        <p class="text-slate-400">No search yet. Use the left panel to query.</p>
      </div>
      <div class="mt-6">
        <h4 class="text-sm font-medium text-slate-300 mb-2">Search History</h4>
        <div id="historyList" class="space-y-2 results-scroll p-2"></div>
      </div>
    </aside>
  </main>
</div>

<script>
// Matrix
const c=document.getElementById('matrix'),ctx=c.getContext('2d');function resize(){c.width=innerWidth;c.height=innerHeight}resize();addEventListener('resize',resize);
const chars='01',fs=14,cols=Math.floor(innerWidth/fs);let drops=new Array(cols).fill(1);
setInterval(()=>{ctx.fillStyle='rgba(0,0,0,.06)';ctx.fillRect(0,0,c.width,c.height);ctx.fillStyle='#39ff14';ctx.font=fs+'px monospace';for(let i=0;i<drops.length;i++){ctx.fillText(chars[Math.floor(Math.random()*2)],i*fs,drops[i]*fs);if(drops[i]*fs>c.height&&Math.random()>0.975)drops[i]=0;drops[i]++;}},50);

const input=document.getElementById('inputValue'),status=document.getElementById('status'),resultArea=document.getElementById('resultArea'),latest=document.getElementById('latestCard'),historyList=document.getElementById('historyList');
let history=JSON.parse(localStorage.getItem('sim_history')||'[]');
function renderHistory(){historyList.innerHTML=history.length?'' : '<p class="text-xs text-slate-500">No history yet.</p>';history.slice().reverse().forEach(val=>{let d=document.createElement('div');d.className='flex justify-between bg-slate-800 p-2 rounded text-sm';d.innerHTML=`<span>${val}</span><button data-val="${val}" class='bg-slate-700 px-2 rounded text-xs'>Use</button>`;historyList.appendChild(d)})}
renderHistory();

function makeText(o){if(!o)return '';if(Array.isArray(o))return o.map(e=>makeText(e)).join('\n---\n');return `Name: ${o.Name||'N/A'}\nCNIC: ${o.CNIC||'N/A'}\nNumber: ${o.Numbers||'N/A'}\nAddress: ${o.Address||'N/A'}`;}

function renderResults(data,query){if(!data){status.innerHTML='<div class=text-red-400>No data.</div>';return;}if(query){if(!history.includes(query)){history.push(query);if(history.length>30)history.shift();localStorage.setItem('sim_history',JSON.stringify(history))}renderHistory()}
resultArea.innerHTML='';if(Array.isArray(data)){status.innerHTML=`<div class=text-green-300>Found ${data.length} records</div>`;data.forEach(e=>{let num=e.Numbers&&(e.Numbers[0]!=='0'?'0'+e.Numbers:e.Numbers);let card=document.createElement('div');card.className='bg-slate-800 p-3 rounded mb-3';card.innerHTML=`<strong>${e.Name||'N/A'}</strong><div class=text-xs>${e.CNIC||''}</div><div class=text-xs>${num||''}</div><div class=text-xs>${e.Address||''}</div><div class=mt-2><button class='copy px-2 bg-slate-700 rounded text-xs' data-t='${makeText(e)}'>Copy</button> <button class='wa px-2 bg-green-500 rounded text-xs' data-t='${makeText(e)}'>WhatsApp</button></div>`;resultArea.appendChild(card)});latest.innerHTML=`<strong>${data[0].Name}</strong><div class=text-xs>${data[0].CNIC||''}</div>`;}else{let e=data;let num=e.Numbers&&(e.Numbers[0]!=='0'?'0'+e.Numbers:e.Numbers);status.innerHTML='<div class=text-green-300>Record found</div>';resultArea.innerHTML=`<div class='bg-slate-800 p-3 rounded'><strong>${e.Name||'N/A'}</strong><div class=text-xs>${e.CNIC||''}</div><div class=text-xs>${num||''}</div><div class=text-xs>${e.Address||''}</div><div class=mt-2><button id=copyAll class='px-2 bg-slate-700 rounded text-xs'>Copy</button> <button id=waAll class='px-2 bg-green-500 rounded text-xs'>WhatsApp</button></div></div>`;latest.innerHTML=`<strong>${e.Name}</strong><div class=text-xs>${e.CNIC||''}</div>`;document.getElementById('copyAll').onclick=()=>navigator.clipboard.writeText(makeText(e));document.getElementById('waAll').onclick=()=>window.open('https://wa.me/?text='+encodeURIComponent(makeText(e)),'_blank');}}

resultArea.addEventListener('click',e=>{if(e.target.classList.contains('copy'))navigator.clipboard.writeText(e.target.dataset.t);if(e.target.classList.contains('wa'))window.open('https://wa.me/?text='+encodeURIComponent(e.target.dataset.t),'_blank')});

if(window.__SIM_API_RESPONSE)renderResults(window.__SIM_API_RESPONSE,window.__SIM_API_QUERY);
if(window.__SIM_API_ERROR==='invalid')status.innerHTML='<div class=text-red-400>Invalid input</div>';

document.getElementById('searchForm').addEventListener('submit',ev=>{if(window.__SIM_API_RESPONSE!==undefined)return;ev.preventDefault();let v=input.value.trim();if(!/^(03\d{9}|\d{13})$/.test(v)){status.innerHTML='<div class=text-red-400>Invalid format</div>';return}status.innerHTML='<div class=text-slate-400>Searching…</div>';let param=/^03/.test(v)?v.slice(1):v;fetch('https://ahmadmodstools.online/apis/db.php?num='+encodeURIComponent(param)).then(r=>r.json()).then(js=>{renderResults(js,v)}).catch(()=>{status.innerHTML='<div class=text-red-400>API error or blocked</div>'})});

document.getElementById('pasteBtn').onclick=async()=>{try{input.value=(await navigator.clipboard.readText()).trim()}catch{alert('Clipboard blocked')}};
document.getElementById('historyBtn').onclick=()=>historyList.scrollIntoView({behavior:'smooth'});
historyList.onclick=e=>{if(e.target.dataset.val){input.value=e.target.dataset.val;}};
document.getElementById('contactBtn').onclick=()=>window.open(atob('aHR0cHM6Ly93aGF0c2FwcC5jb20vY2hhbm5lbC8wMDI5VmJCQ0VZSklDVnUxUGh5QUc0MQ=='),'_blank');
document.getElementById('reportBtn').onclick=()=>window.open('https://wa.me/?text='+encodeURIComponent('Issue with SIM lookup for: '+(input.value||'')),'_blank');
</script>
</body>
</html>
